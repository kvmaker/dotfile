* DONE FFWD开发计划 [5/5]
  CLOSED: [2014-02-28 五 09:51]
1. [X] 修正ffwd_dev_fdb的删除问题(参考hi_shash.c)
2. [X] 将整个模块分成多个ko(按照功能划分)
   1. [X] 软件加速模块:hi_kernel_ffwd_core.c
   2. [X] 硬件加速模块:hw/*
3. [X] 解决单向流加速问题
   1. 涉及文件 [9/9]
      1. [X] hi_kernel_ffwd_conntrack.h
		 1. 在hi_kernel_ffwd_conntrack_s中抽象出conn_link数据结构
		 2. 更改hi_kernel_ffwd_conntrack_s->ui_state的定义，参考3.2
      2. [X] hi_kernel_ffwd_conntrack.c
		 1. 更改状态机
	     2. 更改hw_add/hw_del/hw_alive/hw_age的形式，允许单边加速。
      3. [X] hi_kernel_ffwd_core.c
		 1. 单边加速
		 2. 对于只有单边link，并且需要发送icmp的情况，将其转交给协议栈处理
      4. [X] hi_kernel_ffwd_acct.c
		 1. 一个link对应一个acct
      5. [X] hi_kernel_ffwd_policy.c
		 1. 支持单边加速
      6. [X] hi_kernel_ffwd_l3proto.c
		 1. __l3proto_act支持单边
      7. [X] hi_kernel_ffwd_l4proto.c
		 1. __l4proto_act支持单边
	  8. [X] hi_kernel_ffwd_hw_napt.c
	  9. [X] hi_kernel_ffwd_app.c
		 1. 按照LINK获取flags的方法获取conn的flags
		 2. 在此处确定pst_conn->ui_type，policy中的ui_type删除
   2. 简化的状态转移图
      #+BEGIN_ASCII
           +-----------+
           |  LINK_UP  |
           +-------^---+
              |    |   
   (link_down)|    |(link_up)
              |    |
           +--v--------+
           |  KEY_UP   |
           +-------^---+
              |    |
    (key_down)|    |(key_up)
              |    |
           +--v--------+
           |   INIT    |
           +-----------+
      #+END_ASCII
   3. link和conntrack公共的状态机
      #+BEGIN_ASCII
           +------------+
           |     2      |
           +--------^---+
               |    |   
       (down_2)|    |(up_2)
               |    |
           +---v--------+
           |      1     |
           +--------^---+
               |    |
       (down_1)|    |(up_1)
               |    |
           +---v--------+
           |      0     |
           +------------+
      #+END_ASCII
4. [X] 解决IPv6分片问题
   1. 不处理IPv6的分片报文
5. [X] 整理交流胶片
   1. [X] 在sunshine交流稿的基础上形成初稿

* DONE 问题
  CLOSED: [2014-02-28 五 09:52]
1. [X] 在单向流加速中，如何确定连接的加速类型?
   通过出口设备和入口设备确定
2. [X] 什么情况必须要LINK双向都UP才能处理?
   需要发送ICMP分片通知时，不过这种情况可以通过将其转发给协议栈来处理。
* VIF需求
1. dump中的非法值使用N/A表示

* 资料
1. 深圳实验室网络拓扑
   |---------+---------------|
   | HOST    |            IP |
   |---------+---------------|
   | ServerA | 10.67.226.203 |
   | ServerB |   10.67.227.1 |
   | Win7A   |  10.67.227.21 |
   | Win7B   |  10.67.227.28 |
   |---------+---------------|
   #+BEGIN_ASCII
                          +---------+
                          | ServerA |
                          +---------+
                               |(eth1:192.168.1.101)                               ______
                               |                                                 .(      ).
   +---------+                 |                +---------+ (eth2:10.67.227.1)  ( Internet )(eth2:10.167.202.79)  +---------+
   |   ONT   |----------------------------------| ServerB |----------------------(        )-----------------------| Wuhan-B |
   +---------+(192.168.1.100) (eth0:192.168.1.1)+---------+                       ........                        +---------+
        |(192.168.0.100)                             |(eth1:192.168.2.100)
        |                                            |
        |(192.168.0.1)                               |(192.168.2.1)
   +---------+                                  +---------+
   |  Win7A  |                                  |  Win7B  |
   +---------+                                  +---------+
   #+END_ASCII
2. FiberHome计划
   1. 产品:1GE+1POTS、1GE
   2. 硬件开发计划
      |--------------------+-----------+-----------------------|
      | 需求规格分析、立项 | 2个工作日 | 2月10日~2014年2月11日 |
      | 硬件规格书制作     | 1工作日   | 2月12日~2月12         |
      | sch 设计           | 4 工作日  | 2月13日~2月17日       |
      | sch 评审           | 1 工作日  | 2月18日~2月18日       |
      | PCB layout         | 5 工作日  | 2月19日 2014年2月24日 |
      | PCB 评审           | 1 工作日  | 2月25日               |
      | PCB打样,BOM备料    | 6 工作日  | 2月26日~3月5日        |
      | 样机制作           | 2 工作日  | 3月6日~3月7日         |
      | 样机调测和送样     | 2 工作日  | 3月8日~3月9日         |
      |--------------------+-----------+-----------------------|
   3. 软件开发计划
      |--------------------------+-----------------|
      | 软件接口需求说明文档定稿 | 2月10日         |
      | 驱动适配软件开发         | 2月11日-3月2日  |
      | 最小系统镜像文件         | 3月2日          |
      | 系统功能联调完善         | 3月2日-3月10日  |
      | 系统联调                 | 3月11日-3月20日 |
      | 中试                     | 3月21日-4月25日 |
      |--------------------------+-----------------|

* Kernel修改
1. driver\net\ppp_generic.c
2. include\linux\neighbour.h
3. include\net\netfilter\ipv4\nf_conntrack_ipv4.h
4. include\net\netfilter\nf_conntrack_core.h
5. include\net\ip_fib.h
6. include\net\ip6_fib.h
7. net\bridge\br_fdb.c
8. net\core\dev.c
9. net\core\neighbour.c
10. net\ipv4\netfilter\nf_conntrack_l3proto_ipv4.c
11. net\ipv4\fib_frontend.c
12. net\ipv4\fib_hash.c
13. net\ipv4\ipip.c
14. net\ipv6\netfilter\nf_conntrack_l3proto_ipv6.c
15. net\ipv6\ip6_fib.c
16. net\ipv6\ip6_tunnel.c
17. net\ipv6\ndisc.c
18. net\ipv6\route.c
19. net\ipv6\sit.c
20. net\netfilter\nf_conntrack_core.c

